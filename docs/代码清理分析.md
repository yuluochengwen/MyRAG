"""
文本分割功能使用情况分析和清理建议

## 已实现但未使用的功能

### 1. text_splitter.py

#### ✅ 使用中的功能
- `split_text()` - 基础分割（knowledge_base.py:175调用）
- `_get_separators_for_type()` - 根据文档类型选择分隔符（内部使用）
- `_fallback_split()` - 降级分割（内部使用）

#### ❌ 未使用的功能（建议删除或整合）

1. **split_text_with_metadata()** (第148-182行)
   - 功能：分割文本并添加元数据
   - 状态：从未被调用
   - 建议：保留，整合到新的语义分割器中
   - 价值：为Ollama等扩展预留

2. **analyze_chunks()** (第187-236行)
   - 功能：分析chunk质量（边界质量、长度均匀性）
   - 状态：从未被调用
   - 建议：删除或移到测试/调试工具
   - 理由：实际生产环境不需要实时质量分析

3. **_get_recommendation()** (第239-248行)
   - 功能：根据分析给出建议
   - 状态：只被analyze_chunks调用（也未使用）
   - 建议：删除
   - 理由：依赖未使用的analyze_chunks

4. **count_chunks()** (第271-281行)
   - 功能：预计算文本会被分成多少块
   - 状态：从未被调用
   - 建议：删除
   - 理由：实际场景中直接split_text().length更直接

### 2. similarity.py

#### ✅ 使用中的功能
- `normalize_l2_distance_to_similarity()` - L2距离转相似度（被format_search_results调用）
- `format_search_results()` - 格式化检索结果（knowledge_base_service.py:390调用）

#### ❌ 未使用的功能

1. **cosine_similarity()** (第28-52行)
   - 功能：计算余弦相似度
   - 状态：从未被调用
   - 建议：保留（工具函数，未来可能用于语义去重）
   - 理由：低成本维护，有潜在价值

### 3. validators.py

#### ✅ 使用中的功能
- `validate_kb_name()` - 验证知识库名称（knowledge_base.py:35调用）
- `validate_file_extension()` - 验证文件扩展名（knowledge_base.py:273调用）
- `validate_file_size()` - 验证文件大小（file_service.py:51调用）

#### ❌ 未使用的功能

1. **validate_knowledge_base_name()** (第117-139行)
   - 功能：验证知识库名称（返回tuple格式）
   - 状态：导出但从未被调用
   - 建议：删除
   - 理由：与validate_kb_name()重复

2. **sanitize_path()** (第141-158行)
   - 功能：清理路径，防止路径遍历攻击
   - 状态：导出但从未被调用
   - 建议：保留
   - 理由：安全相关，应该使用

3. **format_file_size()** (第160-175行)
   - 功能：格式化文件大小（字节转KB/MB/GB）
   - 状态：导出但从未被调用
   - 建议：保留或移到前端
   - 理由：前端展示用，后端不需要

## 清理计划

### 立即删除（无价值）
- `text_splitter.analyze_chunks()`
- `text_splitter._get_recommendation()`
- `text_splitter.count_chunks()`
- `validators.validate_knowledge_base_name()` （与validate_kb_name重复）

### 整合到新功能
- `text_splitter.split_text_with_metadata()` → 整合到semantic_splitter.py

### 保留但标记未使用
- `similarity.cosine_similarity()` - 添加注释"工具函数，未来语义去重用"
- `validators.sanitize_path()` - 添加TODO"应该在文件上传时使用"
- `validators.format_file_size()` - 添加注释"前端展示用"

### 修复使用缺失
- `validators.sanitize_path()` 应该在 file_service.py 的 save_file() 中使用

## 代码统计

总计：
- 可删除代码：~100行
- 需整合代码：~35行
- 应修复使用：~3处
"""
